{
  "section": 21,
  "title": "Complete User Flows",
  "metadata": {
    "startLine": 6987,
    "endLine": 8130,
    "codeBlockCount": 9,
    "tableCount": 0,
    "extractedAt": "2025-12-01T16:35:09.323Z"
  },
  "codeBlocks": [
    {
      "id": "code-21-0",
      "language": "text",
      "code": "┌─────────────┐\n│   Landing   │\n│    Page     │\n└──────┬──────┘\n       │\n       ├──────────────────┐\n       ↓                  ↓\n┌──────────────┐   ┌─────────────┐\n│    Signup    │   │    Login    │\n│     Page     │   │    Page     │\n└──────┬───────┘   └──────┬──────┘\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   OTP Verify │          │\n└──────┬───────┘          │\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   Signup     │          │\n│   Success    │          │\n└──────┬───────┘          │\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   Create     │          │\n│  Password    │          │\n└──────┬───────┘          │\n       │                  │\n       └──────────┬───────┘\n                  ↓\n           ┌──────────────┐\n           │  Dashboard   │\n           └──────────────┘",
      "lineNumber": 7004
    },
    {
      "id": "code-21-1",
      "language": "tsx",
      "code": "import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport OtpInput from '@/components/ui/OtpInput';\nimport { toast } from '@/components/ui/Toast';\n\nconst SignupPage = () => {\n  const [step, setStep] = useState<'details' | 'otp'>('details');\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    businessName: '',\n    email: '',\n    mobile: '',\n  });\n  const [otp, setOtp] = useState('');\n  const navigate = useNavigate();\n\n  // Step 1: Collect Details\n  const handleSubmitDetails = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      // Send OTP\n      await api.sendSignupOtp({\n        email: formData.email,\n        mobile: formData.mobile,\n      });\n\n      toast.show({\n        type: 'success',\n        title: 'OTP Sent',\n        message: `Verification code sent to ${formData.mobile}`,\n      });\n\n      setStep('otp');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Signup Failed',\n        message: error.message,\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Step 2: Verify OTP\n  const handleVerifyOtp = async (otpValue: string) => {\n    setLoading(true);\n\n    try {\n      const response = await api.verifySignupOtp({\n        mobile: formData.mobile,\n        otp: otpValue,\n      });\n\n      // Store temporary token\n      sessionStorage.setItem('signup-token', response.tempToken);\n\n      toast.show({\n        type: 'success',\n        title: 'Verification Successful',\n        message: 'Account created successfully!',\n      });\n\n      // Navigate to success page\n      navigate('/signup-success');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Verification Failed',\n        message: 'Invalid OTP. Please try again.',\n      });\n      setOtp('');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        {/* Logo */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-white mb-2\">SabPaisa COB</h1>\n          <p className=\"text-white/60\">Core Banking Platform</p>\n        </div>\n\n        <Card variant=\"glass\" padding=\"xl\">\n          {step === 'details' ? (\n            <>\n              <h2 className=\"text-2xl font-bold text-white mb-2\">Create Account</h2>\n              <p className=\"text-white/60 mb-6\">\n                Start your journey with SabPaisa\n              </p>\n\n              <form onSubmit={handleSubmitDetails} className=\"space-y-4\">\n                <TextField\n                  name=\"businessName\"\n                  label=\"Business Name\"\n                  placeholder=\"Your Business Name\"\n                  value={formData.businessName}\n                  onChange={(e) => setFormData({ ...formData, businessName: e.target.value })}\n                  required\n                />\n\n                <TextField\n                  name=\"email\"\n                  label=\"Email Address\"\n                  type=\"email\"\n                  placeholder=\"you@company.com\"\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  required\n                />\n\n                <TextField\n                  name=\"mobile\"\n                  label=\"Mobile Number\"\n                  type=\"tel\"\n                  placeholder=\"+91 98765 43210\"\n                  value={formData.mobile}\n                  onChange={(e) => setFormData({ ...formData, mobile: e.target.value })}\n                  required\n                />\n\n                <Button\n                  variant=\"primary\"\n                  type=\"submit\"\n                  fullWidth\n                  isLoading={loading}\n                >\n                  Continue\n                </Button>\n\n                <p className=\"text-center text-sm text-white/60 mt-4\">\n                  Already have an account?{' '}\n                  <a href=\"/login\" className=\"text-blue-400 hover:text-blue-300\">\n                    Sign In\n                  </a>\n                </p>\n              </form>\n            </>\n          ) : (\n            <>\n              <h2 className=\"text-2xl font-bold text-white mb-2\">Verify Mobile</h2>\n              <p className=\"text-white/60 mb-6\">\n                Enter the 6-digit code sent to {formData.mobile}\n              </p>\n\n              <OtpInput\n                value={otp}\n                onChange={setOtp}\n                onComplete={handleVerifyOtp}\n                disabled={loading}\n              />\n\n              <div className=\"mt-6 flex items-center justify-between\">\n                <button\n                  onClick={() => setStep('details')}\n                  className=\"text-sm text-white/60 hover:text-white\"\n                >\n                  ← Back\n                </button>\n                <button className=\"text-sm text-blue-400 hover:text-blue-300\">\n                  Resend Code\n                </button>\n              </div>\n            </>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default SignupPage;",
      "lineNumber": 7057
    },
    {
      "id": "code-21-2",
      "language": "tsx",
      "code": "import { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { CheckCircle, ArrowRight } from 'lucide-react';\nimport Button from '@/components/ui/Button';\nimport Card from '@/components/ui/Card';\n\nconst SignupSuccessPage = () => {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Check for temp token\n    const token = sessionStorage.getItem('signup-token');\n    if (!token) {\n      navigate('/signup');\n    }\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, scale: 0.9 }}\n        animate={{ opacity: 1, scale: 1 }}\n        className=\"w-full max-w-md\"\n      >\n        <Card variant=\"glass\" padding=\"xl\">\n          <div className=\"text-center\">\n            {/* Success Animation */}\n            <motion.div\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              transition={{ delay: 0.2, type: 'spring', stiffness: 200 }}\n              className=\"w-24 h-24 mx-auto mb-6 bg-green-500/20 rounded-full flex items-center justify-center\"\n            >\n              <CheckCircle className=\"w-12 h-12 text-green-400\" />\n            </motion.div>\n\n            <h2 className=\"text-2xl font-bold text-white mb-2\">\n              Account Created Successfully!\n            </h2>\n            <p className=\"text-white/60 mb-8\">\n              Welcome to SabPaisa. Let's set up your account.\n            </p>\n\n            {/* Next Steps */}\n            <div className=\"space-y-4 mb-8\">\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold mr-3\">\n                  1\n                </div>\n                <span className=\"text-white/90 text-left\">Create your password</span>\n              </div>\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center text-white/60 font-bold mr-3\">\n                  2\n                </div>\n                <span className=\"text-white/60 text-left\">Complete KYC verification</span>\n              </div>\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center text-white/60 font-bold mr-3\">\n                  3\n                </div>\n                <span className=\"text-white/60 text-left\">Start accepting payments</span>\n              </div>\n            </div>\n\n            <Button\n              variant=\"primary\"\n              fullWidth\n              onClick={() => navigate('/create-password')}\n              rightIcon={<ArrowRight className=\"w-5 h-5\" />}\n            >\n              Continue Setup\n            </Button>\n          </div>\n        </Card>\n      </motion.div>\n    </div>\n  );\n};\n\nexport default SignupSuccessPage;",
      "lineNumber": 7248
    },
    {
      "id": "code-21-3",
      "language": "tsx",
      "code": "import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\n\nconst LoginPage = () => {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n  });\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const response = await api.login(formData);\n\n      // Store auth token\n      localStorage.setItem('auth-token', response.token);\n      localStorage.setItem('user', JSON.stringify(response.user));\n\n      toast.show({\n        type: 'success',\n        title: 'Welcome Back!',\n        message: `Logged in as ${response.user.businessName}`,\n      });\n\n      // Navigate to dashboard\n      navigate('/home');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Login Failed',\n        message: error.message || 'Invalid credentials',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-white mb-2\">SabPaisa COB</h1>\n          <p className=\"text-white/60\">Sign in to your account</p>\n        </div>\n\n        <Card variant=\"glass\" padding=\"xl\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <TextField\n              name=\"email\"\n              label=\"Email Address\"\n              type=\"email\"\n              placeholder=\"you@company.com\"\n              value={formData.email}\n              onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n              required\n            />\n\n            <TextField\n              name=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              placeholder=\"••••••••\"\n              value={formData.password}\n              onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n              required\n            />\n\n            <div className=\"flex items-center justify-between text-sm\">\n              <label className=\"flex items-center text-white/70\">\n                <input type=\"checkbox\" className=\"mr-2\" />\n                Remember me\n              </label>\n              <a href=\"/forgot-password\" className=\"text-blue-400 hover:text-blue-300\">\n                Forgot password?\n              </a>\n            </div>\n\n            <Button\n              variant=\"primary\"\n              type=\"submit\"\n              fullWidth\n              isLoading={loading}\n            >\n              Sign In\n            </Button>\n\n            <p className=\"text-center text-sm text-white/60 mt-4\">\n              Don't have an account?{' '}\n              <a href=\"/signup\" className=\"text-blue-400 hover:text-blue-300\">\n                Sign Up\n              </a>\n            </p>\n          </form>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginPage;",
      "lineNumber": 7341
    },
    {
      "id": "code-21-4",
      "language": "text",
      "code": "┌─────────────┐\n│  Dashboard  │\n│   (Prompt)  │\n└──────┬──────┘\n       │\n       ↓\n┌─────────────┐\n│   Entity    │\n│   Type      │\n│  Selection  │\n└──────┬──────┘\n       │\n       ├──────────────────────────┬────────────────┐\n       ↓                          ↓                ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│ Individual  │          │ Proprietor │   │  Company  │\n│     KYC     │          │    KYC     │   │    KYC    │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│   Basic     │          │   Basic    │   │   Basic   │\n│  Details    │          │  Details   │   │  Details  │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│  Document   │          │  Document  │   │  Document │\n│   Upload    │          │   Upload   │   │   Upload  │\n│ (Aadhaar,   │          │ (PAN, GST, │   │ (CIN, GST,│\n│    PAN)     │          │  Shop Act) │   │   Board   │\n│             │          │            │   │Resolution)│\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│    Bank     │          │    Bank    │   │   Bank    │\n│   Details   │          │   Details  │   │  Details  │\n│   + Penny   │          │   + Penny  │   │  + Penny  │\n│    Drop     │          │    Drop    │   │   Drop    │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       └───────────┬───────────┴─────────────────┘\n                   ↓\n            ┌─────────────┐\n            │   Review    │\n            │   Submit    │\n            └──────┬──────┘\n                   │\n                   ↓\n            ┌─────────────┐\n            │ Verification│\n            │  Pending    │\n            └──────┬──────┘\n                   │\n                   ↓\n            ┌─────────────┐\n            │   KYC       │\n            │  Approved   │\n            └─────────────┘",
      "lineNumber": 7457
    },
    {
      "id": "code-21-5",
      "language": "tsx",
      "code": "import { motion } from 'framer-motion';\nimport { User, Briefcase, Building2 } from 'lucide-react';\nimport Card from '@/components/ui/Card';\n\nconst EntityTypeSelector = ({ onSelect }) => {\n  const entityTypes = [\n    {\n      id: 'individual',\n      title: 'Individual',\n      description: 'Personal account for individuals',\n      icon: User,\n      color: 'from-blue-500 to-cyan-500',\n      requiredDocs: ['Aadhaar', 'PAN'],\n    },\n    {\n      id: 'proprietor',\n      title: 'Sole Proprietorship',\n      description: 'For self-employed professionals',\n      icon: Briefcase,\n      color: 'from-teal-500 to-green-500',\n      requiredDocs: ['PAN', 'GST (optional)', 'Shop Act (optional)'],\n    },\n    {\n      id: 'company',\n      title: 'Private Limited Company',\n      description: 'For registered companies',\n      icon: Building2,\n      color: 'from-purple-500 to-pink-500',\n      requiredDocs: ['CIN', 'GST', 'Board Resolution'],\n    },\n  ];\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-8\">\n      <div className=\"text-center mb-12\">\n        <h1 className=\"text-3xl font-bold text-white mb-3\">\n          Complete Your KYC\n        </h1>\n        <p className=\"text-white/70 text-lg\">\n          Select your business entity type to begin verification\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {entityTypes.map((entity, index) => {\n          const Icon = entity.icon;\n          return (\n            <motion.div\n              key={entity.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: index * 0.1 }}\n            >\n              <Card\n                variant=\"glass\"\n                padding=\"lg\"\n                hover={true}\n                onClick={() => onSelect(entity.id)}\n                className=\"cursor-pointer h-full\"\n              >\n                <div className=\"text-center\">\n                  {/* Icon with Gradient */}\n                  <div className={`w-20 h-20 mx-auto mb-6 bg-gradient-to-br ${entity.color} rounded-2xl flex items-center justify-center`}>\n                    <Icon className=\"w-10 h-10 text-white\" />\n                  </div>\n\n                  {/* Title */}\n                  <h3 className=\"text-xl font-bold text-white mb-2\">\n                    {entity.title}\n                  </h3>\n                  <p className=\"text-white/60 text-sm mb-6\">\n                    {entity.description}\n                  </p>\n\n                  {/* Required Documents */}\n                  <div className=\"text-left\">\n                    <p className=\"text-xs font-medium text-white/50 uppercase mb-3\">\n                      Required Documents:\n                    </p>\n                    <ul className=\"space-y-2\">\n                      {entity.requiredDocs.map((doc) => (\n                        <li key={doc} className=\"text-sm text-white/70 flex items-center\">\n                          <span className=\"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2\" />\n                          {doc}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                </div>\n              </Card>\n            </motion.div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default EntityTypeSelector;",
      "lineNumber": 7528
    },
    {
      "id": "code-21-6",
      "language": "tsx",
      "code": "import { useState } from 'react';\nimport Card from '@/components/ui/Card';\nimport FileUpload from '@/components/ui/FileUpload';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\nimport { CheckCircle, AlertCircle } from 'lucide-react';\n\ninterface DocumentUploadStepProps {\n  entityType: 'individual' | 'proprietor' | 'company';\n  onNext: (documents: any) => void;\n  onBack: () => void;\n}\n\nconst DocumentUploadStep: React.FC<DocumentUploadStepProps> = ({\n  entityType,\n  onNext,\n  onBack,\n}) => {\n  const [documents, setDocuments] = useState<Record<string, File[]>>({});\n  const [uploading, setUploading] = useState(false);\n\n  // Document requirements by entity type\n  const requiredDocs = {\n    individual: [\n      { id: 'aadhaar', label: 'Aadhaar Card', required: true },\n      { id: 'pan', label: 'PAN Card', required: true },\n    ],\n    proprietor: [\n      { id: 'pan', label: 'PAN Card', required: true },\n      { id: 'gst', label: 'GST Certificate', required: false },\n      { id: 'shop_act', label: 'Shop Act License', required: false },\n    ],\n    company: [\n      { id: 'cin', label: 'Certificate of Incorporation (CIN)', required: true },\n      { id: 'gst', label: 'GST Certificate', required: true },\n      { id: 'board_resolution', label: 'Board Resolution', required: true },\n      { id: 'moa', label: 'Memorandum of Association', required: false },\n    ],\n  };\n\n  const docs = requiredDocs[entityType];\n\n  const handleUpload = async () => {\n    // Validate required documents\n    const missingDocs = docs\n      .filter((doc) => doc.required && (!documents[doc.id] || documents[doc.id].length === 0))\n      .map((doc) => doc.label);\n\n    if (missingDocs.length > 0) {\n      toast.show({\n        type: 'error',\n        title: 'Missing Documents',\n        message: `Please upload: ${missingDocs.join(', ')}`,\n      });\n      return;\n    }\n\n    setUploading(true);\n\n    try {\n      // Upload each document\n      const uploadedDocs = await Promise.all(\n        Object.entries(documents).map(async ([docType, files]) => {\n          const formData = new FormData();\n          files.forEach((file) => formData.append('file', file));\n          formData.append('docType', docType);\n\n          const response = await api.uploadDocument(formData);\n          return { docType, ...response };\n        })\n      );\n\n      toast.show({\n        type: 'success',\n        title: 'Documents Uploaded',\n        message: 'All documents uploaded successfully.',\n      });\n\n      onNext({ documents: uploadedDocs });\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Upload Failed',\n        message: error.message,\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <Card variant=\"default\" padding=\"lg\">\n      <h2 className=\"text-2xl font-bold text-white mb-2\">Upload Documents</h2>\n      <p className=\"text-white/60 mb-8\">\n        Upload clear images or PDFs of your documents\n      </p>\n\n      <div className=\"space-y-6\">\n        {docs.map((doc) => (\n          <div key={doc.id}>\n            <div className=\"flex items-center justify-between mb-2\">\n              <label className=\"text-sm font-medium text-white flex items-center\">\n                {doc.label}\n                {doc.required && <span className=\"text-red-400 ml-1\">*</span>}\n              </label>\n              {documents[doc.id]?.length > 0 && (\n                <span className=\"text-xs text-green-400 flex items-center\">\n                  <CheckCircle className=\"w-4 h-4 mr-1\" />\n                  Uploaded\n                </span>\n              )}\n            </div>\n\n            <FileUpload\n              name={doc.id}\n              label=\"\"\n              accept=\"image/*,.pdf\"\n              maxSize={5}\n              multiple={false}\n              allowCamera={true}\n              value={documents[doc.id] || []}\n              onChange={(files) =>\n                setDocuments({ ...documents, [doc.id]: files })\n              }\n            />\n          </div>\n        ))}\n      </div>\n\n      {/* Info Banner */}\n      <div className=\"mt-8 p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl\">\n        <div className=\"flex items-start space-x-3\">\n          <AlertCircle className=\"w-5 h-5 text-blue-400 mt-0.5\" />\n          <div className=\"text-sm text-blue-400\">\n            <p className=\"font-medium mb-1\">Document Guidelines:</p>\n            <ul className=\"list-disc list-inside space-y-1 text-blue-400/80\">\n              <li>Ensure documents are clear and readable</li>\n              <li>All four corners should be visible</li>\n              <li>File size should not exceed 5MB</li>\n              <li>Accepted formats: JPG, PNG, PDF</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-between mt-8\">\n        <Button variant=\"ghost\" onClick={onBack}>\n          Back\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={handleUpload}\n          isLoading={uploading}\n        >\n          Continue\n        </Button>\n      </div>\n    </Card>\n  );\n};\n\nexport default DocumentUploadStep;",
      "lineNumber": 7634
    },
    {
      "id": "code-21-7",
      "language": "tsx",
      "code": "import { useState } from 'react';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\nimport { CheckCircle, Loader } from 'lucide-react';\n\nconst BankDetailsStep = ({ onNext, onBack }) => {\n  const [bankDetails, setBankDetails] = useState({\n    accountNumber: '',\n    accountHolderName: '',\n    ifscCode: '',\n    bankName: '',\n    branchName: '',\n  });\n  const [verifying, setVerifying] = useState(false);\n  const [verified, setVerified] = useState(false);\n\n  const handlePennyDrop = async () => {\n    if (!bankDetails.accountNumber || !bankDetails.ifscCode) {\n      toast.show({\n        type: 'error',\n        title: 'Missing Information',\n        message: 'Please enter account number and IFSC code.',\n      });\n      return;\n    }\n\n    setVerifying(true);\n\n    try {\n      const response = await api.verifyBankAccount({\n        accountNumber: bankDetails.accountNumber,\n        ifscCode: bankDetails.ifscCode,\n      });\n\n      if (response.verified) {\n        setVerified(true);\n        setBankDetails({\n          ...bankDetails,\n          accountHolderName: response.accountHolderName,\n          bankName: response.bankName,\n          branchName: response.branchName,\n        });\n\n        toast.show({\n          type: 'success',\n          title: 'Account Verified',\n          message: `Account holder: ${response.accountHolderName}`,\n        });\n      } else {\n        toast.show({\n          type: 'error',\n          title: 'Verification Failed',\n          message: 'Could not verify bank account. Please check details.',\n        });\n      }\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Verification Failed',\n        message: error.message,\n      });\n    } finally {\n      setVerifying(false);\n    }\n  };\n\n  const handleSubmit = () => {\n    if (!verified) {\n      toast.show({\n        type: 'warning',\n        title: 'Verification Required',\n        message: 'Please verify your bank account before continuing.',\n      });\n      return;\n    }\n\n    onNext({ bankDetails });\n  };\n\n  return (\n    <Card variant=\"default\" padding=\"lg\">\n      <h2 className=\"text-2xl font-bold text-white mb-2\">Bank Account Details</h2>\n      <p className=\"text-white/60 mb-8\">\n        Add your bank account for settlement\n      </p>\n\n      <div className=\"space-y-6\">\n        <TextField\n          name=\"accountNumber\"\n          label=\"Account Number\"\n          placeholder=\"1234567890\"\n          value={bankDetails.accountNumber}\n          onChange={(e) => setBankDetails({ ...bankDetails, accountNumber: e.target.value })}\n          required\n        />\n\n        <TextField\n          name=\"ifscCode\"\n          label=\"IFSC Code\"\n          placeholder=\"SBIN0001234\"\n          value={bankDetails.ifscCode}\n          onChange={(e) => setBankDetails({ ...bankDetails, ifscCode: e.target.value.toUpperCase() })}\n          required\n        />\n\n        {/* Verify Button */}\n        {!verified && (\n          <Button\n            variant=\"secondary\"\n            onClick={handlePennyDrop}\n            isLoading={verifying}\n            fullWidth\n          >\n            {verifying ? 'Verifying...' : 'Verify Account (Penny Drop)'}\n          </Button>\n        )}\n\n        {/* Verified Details */}\n        {verified && (\n          <div className=\"p-4 bg-green-500/10 border border-green-500/20 rounded-xl\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <CheckCircle className=\"w-6 h-6 text-green-400\" />\n              <span className=\"text-green-400 font-medium\">Account Verified</span>\n            </div>\n\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Account Holder:</span>\n                <span className=\"text-white font-medium\">{bankDetails.accountHolderName}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Bank:</span>\n                <span className=\"text-white font-medium\">{bankDetails.bankName}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Branch:</span>\n                <span className=\"text-white font-medium\">{bankDetails.branchName}</span>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-between mt-8\">\n        <Button variant=\"ghost\" onClick={onBack}>\n          Back\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={handleSubmit}\n          disabled={!verified}\n        >\n          Continue\n        </Button>\n      </div>\n    </Card>\n  );\n};\n\nexport default BankDetailsStep;",
      "lineNumber": 7804
    },
    {
      "id": "code-21-8",
      "language": "tsx",
      "code": "import { useState, useEffect } from 'react';\nimport Card from '@/components/ui/Card';\nimport DataTable from '@/components/patterns/DataTable';\nimport Pagination from '@/components/patterns/Pagination';\nimport FilterPanel from '@/components/patterns/FilterPanel';\nimport RefundModal from '@/components/Transactions/RefundModal';\nimport { formatCurrency } from '@/utils/transactionHelpers';\n\nconst TransactionsPage = () => {\n  const [transactions, setTransactions] = useState([]);\n  const [filters, setFilters] = useState({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [selectedTxn, setSelectedTxn] = useState(null);\n  const [showRefundModal, setShowRefundModal] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchTransactions();\n  }, [filters, currentPage]);\n\n  const fetchTransactions = async () => {\n    setLoading(true);\n    try {\n      const response = await api.getTransactions({\n        ...filters,\n        page: currentPage,\n        limit: 20,\n      });\n      setTransactions(response.data);\n      setTotalPages(response.totalPages);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const columns = [\n    {\n      key: 'id',\n      header: 'Transaction ID',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"font-mono text-sm\">{txn.id}</span>\n      ),\n    },\n    {\n      key: 'createdAt',\n      header: 'Date & Time',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"text-sm\">\n          {new Date(txn.createdAt).toLocaleString('en-IN')}\n        </span>\n      ),\n    },\n    {\n      key: 'amount',\n      header: 'Amount',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"font-medium\">{formatCurrency(txn.amount)}</span>\n      ),\n    },\n    {\n      key: 'status',\n      header: 'Status',\n      render: (txn) => (\n        <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n          txn.status === 'success'\n            ? 'bg-green-500/20 text-green-400 border border-green-400/30'\n            : txn.status === 'pending'\n            ? 'bg-yellow-500/20 text-yellow-400 border border-yellow-400/30'\n            : 'bg-red-500/20 text-red-400 border border-red-400/30'\n        }`}>\n          {txn.status.toUpperCase()}\n        </span>\n      ),\n    },\n    {\n      key: 'actions',\n      header: 'Actions',\n      render: (txn) => (\n        <button\n          onClick={() => {\n            setSelectedTxn(txn);\n            setShowRefundModal(true);\n          }}\n          className=\"text-sm text-blue-400 hover:text-blue-300\"\n          disabled={txn.status !== 'success'}\n        >\n          Refund\n        </button>\n      ),\n    },\n  ];\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold text-white\">Transactions</h1>\n        <p className=\"text-white/60 mt-2\">View and manage all transactions</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n        {/* Filters Sidebar */}\n        <div className=\"lg:col-span-1\">\n          <FilterPanel filters={filters} onFilterChange={setFilters} />\n        </div>\n\n        {/* Transactions Table */}\n        <div className=\"lg:col-span-3\">\n          <Card variant=\"default\" padding=\"none\">\n            <DataTable\n              data={transactions}\n              columns={columns}\n              onRowClick={(txn) => console.log('View details:', txn)}\n              loading={loading}\n            />\n            <Pagination\n              currentPage={currentPage}\n              totalPages={totalPages}\n              onPageChange={setCurrentPage}\n            />\n          </Card>\n        </div>\n      </div>\n\n      {/* Refund Modal */}\n      {selectedTxn && (\n        <RefundModal\n          transaction={selectedTxn}\n          isOpen={showRefundModal}\n          onClose={() => setShowRefundModal(false)}\n          onConfirm={async (amount, reason) => {\n            await api.processRefund(selectedTxn.id, { amount, reason });\n            fetchTransactions();\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default TransactionsPage;",
      "lineNumber": 7980
    }
  ],
  "tables": [],
  "content": "## Section 21: Complete User Flows\n\n### 21.1 Overview\n\n**Description**: End-to-end user journeys with screen-by-screen documentation, state management, and transition patterns.\n\n**Key Flows Documented**:\n1. Authentication Flow (Signup → Login → Password Creation)\n2. KYC Onboarding Flow (Entity Selection → Document Upload → Verification)\n3. Transaction Management Flow (View → Filter → Refund)\n4. Dashboard Overview Flow\n\n---\n\n## 21.2 Authentication Flow\n\n### Flow Diagram\n```\n┌─────────────┐\n│   Landing   │\n│    Page     │\n└──────┬──────┘\n       │\n       ├──────────────────┐\n       ↓                  ↓\n┌──────────────┐   ┌─────────────┐\n│    Signup    │   │    Login    │\n│     Page     │   │    Page     │\n└──────┬───────┘   └──────┬──────┘\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   OTP Verify │          │\n└──────┬───────┘          │\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   Signup     │          │\n│   Success    │          │\n└──────┬───────┘          │\n       │                  │\n       ↓                  │\n┌──────────────┐          │\n│   Create     │          │\n│  Password    │          │\n└──────┬───────┘          │\n       │                  │\n       └──────────┬───────┘\n                  ↓\n           ┌──────────────┐\n           │  Dashboard   │\n           └──────────────┘\n```\n\n---\n\n### 21.2.1 Signup Page\n\n**Route**: `/signup`\n\n**Purpose**: User registration with email/mobile verification\n\n**Components Used**:\n- `TextField` (email, mobile, business name)\n- `Button` (primary CTA)\n- `OtpInput` (verification)\n- `Card` (form container)\n- `Toast` (feedback)\n\n**Complete Implementation**:\n```tsx\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport OtpInput from '@/components/ui/OtpInput';\nimport { toast } from '@/components/ui/Toast';\n\nconst SignupPage = () => {\n  const [step, setStep] = useState<'details' | 'otp'>('details');\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    businessName: '',\n    email: '',\n    mobile: '',\n  });\n  const [otp, setOtp] = useState('');\n  const navigate = useNavigate();\n\n  // Step 1: Collect Details\n  const handleSubmitDetails = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      // Send OTP\n      await api.sendSignupOtp({\n        email: formData.email,\n        mobile: formData.mobile,\n      });\n\n      toast.show({\n        type: 'success',\n        title: 'OTP Sent',\n        message: `Verification code sent to ${formData.mobile}`,\n      });\n\n      setStep('otp');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Signup Failed',\n        message: error.message,\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Step 2: Verify OTP\n  const handleVerifyOtp = async (otpValue: string) => {\n    setLoading(true);\n\n    try {\n      const response = await api.verifySignupOtp({\n        mobile: formData.mobile,\n        otp: otpValue,\n      });\n\n      // Store temporary token\n      sessionStorage.setItem('signup-token', response.tempToken);\n\n      toast.show({\n        type: 'success',\n        title: 'Verification Successful',\n        message: 'Account created successfully!',\n      });\n\n      // Navigate to success page\n      navigate('/signup-success');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Verification Failed',\n        message: 'Invalid OTP. Please try again.',\n      });\n      setOtp('');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        {/* Logo */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-white mb-2\">SabPaisa COB</h1>\n          <p className=\"text-white/60\">Core Banking Platform</p>\n        </div>\n\n        <Card variant=\"glass\" padding=\"xl\">\n          {step === 'details' ? (\n            <>\n              <h2 className=\"text-2xl font-bold text-white mb-2\">Create Account</h2>\n              <p className=\"text-white/60 mb-6\">\n                Start your journey with SabPaisa\n              </p>\n\n              <form onSubmit={handleSubmitDetails} className=\"space-y-4\">\n                <TextField\n                  name=\"businessName\"\n                  label=\"Business Name\"\n                  placeholder=\"Your Business Name\"\n                  value={formData.businessName}\n                  onChange={(e) => setFormData({ ...formData, businessName: e.target.value })}\n                  required\n                />\n\n                <TextField\n                  name=\"email\"\n                  label=\"Email Address\"\n                  type=\"email\"\n                  placeholder=\"you@company.com\"\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  required\n                />\n\n                <TextField\n                  name=\"mobile\"\n                  label=\"Mobile Number\"\n                  type=\"tel\"\n                  placeholder=\"+91 98765 43210\"\n                  value={formData.mobile}\n                  onChange={(e) => setFormData({ ...formData, mobile: e.target.value })}\n                  required\n                />\n\n                <Button\n                  variant=\"primary\"\n                  type=\"submit\"\n                  fullWidth\n                  isLoading={loading}\n                >\n                  Continue\n                </Button>\n\n                <p className=\"text-center text-sm text-white/60 mt-4\">\n                  Already have an account?{' '}\n                  <a href=\"/login\" className=\"text-blue-400 hover:text-blue-300\">\n                    Sign In\n                  </a>\n                </p>\n              </form>\n            </>\n          ) : (\n            <>\n              <h2 className=\"text-2xl font-bold text-white mb-2\">Verify Mobile</h2>\n              <p className=\"text-white/60 mb-6\">\n                Enter the 6-digit code sent to {formData.mobile}\n              </p>\n\n              <OtpInput\n                value={otp}\n                onChange={setOtp}\n                onComplete={handleVerifyOtp}\n                disabled={loading}\n              />\n\n              <div className=\"mt-6 flex items-center justify-between\">\n                <button\n                  onClick={() => setStep('details')}\n                  className=\"text-sm text-white/60 hover:text-white\"\n                >\n                  ← Back\n                </button>\n                <button className=\"text-sm text-blue-400 hover:text-blue-300\">\n                  Resend Code\n                </button>\n              </div>\n            </>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default SignupPage;\n```\n\n---\n\n### 21.2.2 Signup Success Page\n\n**Route**: `/signup-success`\n\n**Purpose**: Confirmation and next steps after successful registration\n\n```tsx\nimport { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { CheckCircle, ArrowRight } from 'lucide-react';\nimport Button from '@/components/ui/Button';\nimport Card from '@/components/ui/Card';\n\nconst SignupSuccessPage = () => {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Check for temp token\n    const token = sessionStorage.getItem('signup-token');\n    if (!token) {\n      navigate('/signup');\n    }\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, scale: 0.9 }}\n        animate={{ opacity: 1, scale: 1 }}\n        className=\"w-full max-w-md\"\n      >\n        <Card variant=\"glass\" padding=\"xl\">\n          <div className=\"text-center\">\n            {/* Success Animation */}\n            <motion.div\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              transition={{ delay: 0.2, type: 'spring', stiffness: 200 }}\n              className=\"w-24 h-24 mx-auto mb-6 bg-green-500/20 rounded-full flex items-center justify-center\"\n            >\n              <CheckCircle className=\"w-12 h-12 text-green-400\" />\n            </motion.div>\n\n            <h2 className=\"text-2xl font-bold text-white mb-2\">\n              Account Created Successfully!\n            </h2>\n            <p className=\"text-white/60 mb-8\">\n              Welcome to SabPaisa. Let's set up your account.\n            </p>\n\n            {/* Next Steps */}\n            <div className=\"space-y-4 mb-8\">\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold mr-3\">\n                  1\n                </div>\n                <span className=\"text-white/90 text-left\">Create your password</span>\n              </div>\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center text-white/60 font-bold mr-3\">\n                  2\n                </div>\n                <span className=\"text-white/60 text-left\">Complete KYC verification</span>\n              </div>\n              <div className=\"flex items-center p-4 bg-white/5 rounded-xl\">\n                <div className=\"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center text-white/60 font-bold mr-3\">\n                  3\n                </div>\n                <span className=\"text-white/60 text-left\">Start accepting payments</span>\n              </div>\n            </div>\n\n            <Button\n              variant=\"primary\"\n              fullWidth\n              onClick={() => navigate('/create-password')}\n              rightIcon={<ArrowRight className=\"w-5 h-5\" />}\n            >\n              Continue Setup\n            </Button>\n          </div>\n        </Card>\n      </motion.div>\n    </div>\n  );\n};\n\nexport default SignupSuccessPage;\n```\n\n---\n\n### 21.2.3 Login Page\n\n**Route**: `/login`\n\n**Purpose**: Existing user authentication\n\n```tsx\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\n\nconst LoginPage = () => {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n  });\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const response = await api.login(formData);\n\n      // Store auth token\n      localStorage.setItem('auth-token', response.token);\n      localStorage.setItem('user', JSON.stringify(response.user));\n\n      toast.show({\n        type: 'success',\n        title: 'Welcome Back!',\n        message: `Logged in as ${response.user.businessName}`,\n      });\n\n      // Navigate to dashboard\n      navigate('/home');\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Login Failed',\n        message: error.message || 'Invalid credentials',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-white mb-2\">SabPaisa COB</h1>\n          <p className=\"text-white/60\">Sign in to your account</p>\n        </div>\n\n        <Card variant=\"glass\" padding=\"xl\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <TextField\n              name=\"email\"\n              label=\"Email Address\"\n              type=\"email\"\n              placeholder=\"you@company.com\"\n              value={formData.email}\n              onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n              required\n            />\n\n            <TextField\n              name=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              placeholder=\"••••••••\"\n              value={formData.password}\n              onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n              required\n            />\n\n            <div className=\"flex items-center justify-between text-sm\">\n              <label className=\"flex items-center text-white/70\">\n                <input type=\"checkbox\" className=\"mr-2\" />\n                Remember me\n              </label>\n              <a href=\"/forgot-password\" className=\"text-blue-400 hover:text-blue-300\">\n                Forgot password?\n              </a>\n            </div>\n\n            <Button\n              variant=\"primary\"\n              type=\"submit\"\n              fullWidth\n              isLoading={loading}\n            >\n              Sign In\n            </Button>\n\n            <p className=\"text-center text-sm text-white/60 mt-4\">\n              Don't have an account?{' '}\n              <a href=\"/signup\" className=\"text-blue-400 hover:text-blue-300\">\n                Sign Up\n              </a>\n            </p>\n          </form>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginPage;\n```\n\n---\n\n## 21.3 KYC Onboarding Flow\n\n### Flow Diagram\n```\n┌─────────────┐\n│  Dashboard  │\n│   (Prompt)  │\n└──────┬──────┘\n       │\n       ↓\n┌─────────────┐\n│   Entity    │\n│   Type      │\n│  Selection  │\n└──────┬──────┘\n       │\n       ├──────────────────────────┬────────────────┐\n       ↓                          ↓                ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│ Individual  │          │ Proprietor │   │  Company  │\n│     KYC     │          │    KYC     │   │    KYC    │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│   Basic     │          │   Basic    │   │   Basic   │\n│  Details    │          │  Details   │   │  Details  │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│  Document   │          │  Document  │   │  Document │\n│   Upload    │          │   Upload   │   │   Upload  │\n│ (Aadhaar,   │          │ (PAN, GST, │   │ (CIN, GST,│\n│    PAN)     │          │  Shop Act) │   │   Board   │\n│             │          │            │   │Resolution)│\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       ↓                       ↓                 ↓\n┌─────────────┐          ┌────────────┐   ┌───────────┐\n│    Bank     │          │    Bank    │   │   Bank    │\n│   Details   │          │   Details  │   │  Details  │\n│   + Penny   │          │   + Penny  │   │  + Penny  │\n│    Drop     │          │    Drop    │   │   Drop    │\n└──────┬──────┘          └─────┬──────┘   └─────┬─────┘\n       │                       │                 │\n       └───────────┬───────────┴─────────────────┘\n                   ↓\n            ┌─────────────┐\n            │   Review    │\n            │   Submit    │\n            └──────┬──────┘\n                   │\n                   ↓\n            ┌─────────────┐\n            │ Verification│\n            │  Pending    │\n            └──────┬──────┘\n                   │\n                   ↓\n            ┌─────────────┐\n            │   KYC       │\n            │  Approved   │\n            └─────────────┘\n```\n\n---\n\n### 21.3.1 Entity Type Selection\n\n**Route**: `/dashboard/complete-kyc` or `/kyc/entity-type`\n\n**Purpose**: Choose business entity type for appropriate KYC flow\n\n```tsx\nimport { motion } from 'framer-motion';\nimport { User, Briefcase, Building2 } from 'lucide-react';\nimport Card from '@/components/ui/Card';\n\nconst EntityTypeSelector = ({ onSelect }) => {\n  const entityTypes = [\n    {\n      id: 'individual',\n      title: 'Individual',\n      description: 'Personal account for individuals',\n      icon: User,\n      color: 'from-blue-500 to-cyan-500',\n      requiredDocs: ['Aadhaar', 'PAN'],\n    },\n    {\n      id: 'proprietor',\n      title: 'Sole Proprietorship',\n      description: 'For self-employed professionals',\n      icon: Briefcase,\n      color: 'from-teal-500 to-green-500',\n      requiredDocs: ['PAN', 'GST (optional)', 'Shop Act (optional)'],\n    },\n    {\n      id: 'company',\n      title: 'Private Limited Company',\n      description: 'For registered companies',\n      icon: Building2,\n      color: 'from-purple-500 to-pink-500',\n      requiredDocs: ['CIN', 'GST', 'Board Resolution'],\n    },\n  ];\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-8\">\n      <div className=\"text-center mb-12\">\n        <h1 className=\"text-3xl font-bold text-white mb-3\">\n          Complete Your KYC\n        </h1>\n        <p className=\"text-white/70 text-lg\">\n          Select your business entity type to begin verification\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {entityTypes.map((entity, index) => {\n          const Icon = entity.icon;\n          return (\n            <motion.div\n              key={entity.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: index * 0.1 }}\n            >\n              <Card\n                variant=\"glass\"\n                padding=\"lg\"\n                hover={true}\n                onClick={() => onSelect(entity.id)}\n                className=\"cursor-pointer h-full\"\n              >\n                <div className=\"text-center\">\n                  {/* Icon with Gradient */}\n                  <div className={`w-20 h-20 mx-auto mb-6 bg-gradient-to-br ${entity.color} rounded-2xl flex items-center justify-center`}>\n                    <Icon className=\"w-10 h-10 text-white\" />\n                  </div>\n\n                  {/* Title */}\n                  <h3 className=\"text-xl font-bold text-white mb-2\">\n                    {entity.title}\n                  </h3>\n                  <p className=\"text-white/60 text-sm mb-6\">\n                    {entity.description}\n                  </p>\n\n                  {/* Required Documents */}\n                  <div className=\"text-left\">\n                    <p className=\"text-xs font-medium text-white/50 uppercase mb-3\">\n                      Required Documents:\n                    </p>\n                    <ul className=\"space-y-2\">\n                      {entity.requiredDocs.map((doc) => (\n                        <li key={doc} className=\"text-sm text-white/70 flex items-center\">\n                          <span className=\"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2\" />\n                          {doc}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                </div>\n              </Card>\n            </motion.div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default EntityTypeSelector;\n```\n\n---\n\n### 21.3.2 Document Upload Step\n\n```tsx\nimport { useState } from 'react';\nimport Card from '@/components/ui/Card';\nimport FileUpload from '@/components/ui/FileUpload';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\nimport { CheckCircle, AlertCircle } from 'lucide-react';\n\ninterface DocumentUploadStepProps {\n  entityType: 'individual' | 'proprietor' | 'company';\n  onNext: (documents: any) => void;\n  onBack: () => void;\n}\n\nconst DocumentUploadStep: React.FC<DocumentUploadStepProps> = ({\n  entityType,\n  onNext,\n  onBack,\n}) => {\n  const [documents, setDocuments] = useState<Record<string, File[]>>({});\n  const [uploading, setUploading] = useState(false);\n\n  // Document requirements by entity type\n  const requiredDocs = {\n    individual: [\n      { id: 'aadhaar', label: 'Aadhaar Card', required: true },\n      { id: 'pan', label: 'PAN Card', required: true },\n    ],\n    proprietor: [\n      { id: 'pan', label: 'PAN Card', required: true },\n      { id: 'gst', label: 'GST Certificate', required: false },\n      { id: 'shop_act', label: 'Shop Act License', required: false },\n    ],\n    company: [\n      { id: 'cin', label: 'Certificate of Incorporation (CIN)', required: true },\n      { id: 'gst', label: 'GST Certificate', required: true },\n      { id: 'board_resolution', label: 'Board Resolution', required: true },\n      { id: 'moa', label: 'Memorandum of Association', required: false },\n    ],\n  };\n\n  const docs = requiredDocs[entityType];\n\n  const handleUpload = async () => {\n    // Validate required documents\n    const missingDocs = docs\n      .filter((doc) => doc.required && (!documents[doc.id] || documents[doc.id].length === 0))\n      .map((doc) => doc.label);\n\n    if (missingDocs.length > 0) {\n      toast.show({\n        type: 'error',\n        title: 'Missing Documents',\n        message: `Please upload: ${missingDocs.join(', ')}`,\n      });\n      return;\n    }\n\n    setUploading(true);\n\n    try {\n      // Upload each document\n      const uploadedDocs = await Promise.all(\n        Object.entries(documents).map(async ([docType, files]) => {\n          const formData = new FormData();\n          files.forEach((file) => formData.append('file', file));\n          formData.append('docType', docType);\n\n          const response = await api.uploadDocument(formData);\n          return { docType, ...response };\n        })\n      );\n\n      toast.show({\n        type: 'success',\n        title: 'Documents Uploaded',\n        message: 'All documents uploaded successfully.',\n      });\n\n      onNext({ documents: uploadedDocs });\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Upload Failed',\n        message: error.message,\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <Card variant=\"default\" padding=\"lg\">\n      <h2 className=\"text-2xl font-bold text-white mb-2\">Upload Documents</h2>\n      <p className=\"text-white/60 mb-8\">\n        Upload clear images or PDFs of your documents\n      </p>\n\n      <div className=\"space-y-6\">\n        {docs.map((doc) => (\n          <div key={doc.id}>\n            <div className=\"flex items-center justify-between mb-2\">\n              <label className=\"text-sm font-medium text-white flex items-center\">\n                {doc.label}\n                {doc.required && <span className=\"text-red-400 ml-1\">*</span>}\n              </label>\n              {documents[doc.id]?.length > 0 && (\n                <span className=\"text-xs text-green-400 flex items-center\">\n                  <CheckCircle className=\"w-4 h-4 mr-1\" />\n                  Uploaded\n                </span>\n              )}\n            </div>\n\n            <FileUpload\n              name={doc.id}\n              label=\"\"\n              accept=\"image/*,.pdf\"\n              maxSize={5}\n              multiple={false}\n              allowCamera={true}\n              value={documents[doc.id] || []}\n              onChange={(files) =>\n                setDocuments({ ...documents, [doc.id]: files })\n              }\n            />\n          </div>\n        ))}\n      </div>\n\n      {/* Info Banner */}\n      <div className=\"mt-8 p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl\">\n        <div className=\"flex items-start space-x-3\">\n          <AlertCircle className=\"w-5 h-5 text-blue-400 mt-0.5\" />\n          <div className=\"text-sm text-blue-400\">\n            <p className=\"font-medium mb-1\">Document Guidelines:</p>\n            <ul className=\"list-disc list-inside space-y-1 text-blue-400/80\">\n              <li>Ensure documents are clear and readable</li>\n              <li>All four corners should be visible</li>\n              <li>File size should not exceed 5MB</li>\n              <li>Accepted formats: JPG, PNG, PDF</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-between mt-8\">\n        <Button variant=\"ghost\" onClick={onBack}>\n          Back\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={handleUpload}\n          isLoading={uploading}\n        >\n          Continue\n        </Button>\n      </div>\n    </Card>\n  );\n};\n\nexport default DocumentUploadStep;\n```\n\n---\n\n### 21.3.3 Bank Details with Penny Drop\n\n```tsx\nimport { useState } from 'react';\nimport Card from '@/components/ui/Card';\nimport TextField from '@/components/ui/TextField';\nimport Button from '@/components/ui/Button';\nimport { toast } from '@/components/ui/Toast';\nimport { CheckCircle, Loader } from 'lucide-react';\n\nconst BankDetailsStep = ({ onNext, onBack }) => {\n  const [bankDetails, setBankDetails] = useState({\n    accountNumber: '',\n    accountHolderName: '',\n    ifscCode: '',\n    bankName: '',\n    branchName: '',\n  });\n  const [verifying, setVerifying] = useState(false);\n  const [verified, setVerified] = useState(false);\n\n  const handlePennyDrop = async () => {\n    if (!bankDetails.accountNumber || !bankDetails.ifscCode) {\n      toast.show({\n        type: 'error',\n        title: 'Missing Information',\n        message: 'Please enter account number and IFSC code.',\n      });\n      return;\n    }\n\n    setVerifying(true);\n\n    try {\n      const response = await api.verifyBankAccount({\n        accountNumber: bankDetails.accountNumber,\n        ifscCode: bankDetails.ifscCode,\n      });\n\n      if (response.verified) {\n        setVerified(true);\n        setBankDetails({\n          ...bankDetails,\n          accountHolderName: response.accountHolderName,\n          bankName: response.bankName,\n          branchName: response.branchName,\n        });\n\n        toast.show({\n          type: 'success',\n          title: 'Account Verified',\n          message: `Account holder: ${response.accountHolderName}`,\n        });\n      } else {\n        toast.show({\n          type: 'error',\n          title: 'Verification Failed',\n          message: 'Could not verify bank account. Please check details.',\n        });\n      }\n    } catch (error) {\n      toast.show({\n        type: 'error',\n        title: 'Verification Failed',\n        message: error.message,\n      });\n    } finally {\n      setVerifying(false);\n    }\n  };\n\n  const handleSubmit = () => {\n    if (!verified) {\n      toast.show({\n        type: 'warning',\n        title: 'Verification Required',\n        message: 'Please verify your bank account before continuing.',\n      });\n      return;\n    }\n\n    onNext({ bankDetails });\n  };\n\n  return (\n    <Card variant=\"default\" padding=\"lg\">\n      <h2 className=\"text-2xl font-bold text-white mb-2\">Bank Account Details</h2>\n      <p className=\"text-white/60 mb-8\">\n        Add your bank account for settlement\n      </p>\n\n      <div className=\"space-y-6\">\n        <TextField\n          name=\"accountNumber\"\n          label=\"Account Number\"\n          placeholder=\"1234567890\"\n          value={bankDetails.accountNumber}\n          onChange={(e) => setBankDetails({ ...bankDetails, accountNumber: e.target.value })}\n          required\n        />\n\n        <TextField\n          name=\"ifscCode\"\n          label=\"IFSC Code\"\n          placeholder=\"SBIN0001234\"\n          value={bankDetails.ifscCode}\n          onChange={(e) => setBankDetails({ ...bankDetails, ifscCode: e.target.value.toUpperCase() })}\n          required\n        />\n\n        {/* Verify Button */}\n        {!verified && (\n          <Button\n            variant=\"secondary\"\n            onClick={handlePennyDrop}\n            isLoading={verifying}\n            fullWidth\n          >\n            {verifying ? 'Verifying...' : 'Verify Account (Penny Drop)'}\n          </Button>\n        )}\n\n        {/* Verified Details */}\n        {verified && (\n          <div className=\"p-4 bg-green-500/10 border border-green-500/20 rounded-xl\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <CheckCircle className=\"w-6 h-6 text-green-400\" />\n              <span className=\"text-green-400 font-medium\">Account Verified</span>\n            </div>\n\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Account Holder:</span>\n                <span className=\"text-white font-medium\">{bankDetails.accountHolderName}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Bank:</span>\n                <span className=\"text-white font-medium\">{bankDetails.bankName}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-white/60\">Branch:</span>\n                <span className=\"text-white font-medium\">{bankDetails.branchName}</span>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-between mt-8\">\n        <Button variant=\"ghost\" onClick={onBack}>\n          Back\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={handleSubmit}\n          disabled={!verified}\n        >\n          Continue\n        </Button>\n      </div>\n    </Card>\n  );\n};\n\nexport default BankDetailsStep;\n```\n\n---\n\n## 21.4 Transaction Management Flow\n\n### 21.4.1 Transactions List Page\n\n**Route**: `/txns`\n\n**Purpose**: View and filter all transactions\n\n```tsx\nimport { useState, useEffect } from 'react';\nimport Card from '@/components/ui/Card';\nimport DataTable from '@/components/patterns/DataTable';\nimport Pagination from '@/components/patterns/Pagination';\nimport FilterPanel from '@/components/patterns/FilterPanel';\nimport RefundModal from '@/components/Transactions/RefundModal';\nimport { formatCurrency } from '@/utils/transactionHelpers';\n\nconst TransactionsPage = () => {\n  const [transactions, setTransactions] = useState([]);\n  const [filters, setFilters] = useState({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [selectedTxn, setSelectedTxn] = useState(null);\n  const [showRefundModal, setShowRefundModal] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchTransactions();\n  }, [filters, currentPage]);\n\n  const fetchTransactions = async () => {\n    setLoading(true);\n    try {\n      const response = await api.getTransactions({\n        ...filters,\n        page: currentPage,\n        limit: 20,\n      });\n      setTransactions(response.data);\n      setTotalPages(response.totalPages);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const columns = [\n    {\n      key: 'id',\n      header: 'Transaction ID',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"font-mono text-sm\">{txn.id}</span>\n      ),\n    },\n    {\n      key: 'createdAt',\n      header: 'Date & Time',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"text-sm\">\n          {new Date(txn.createdAt).toLocaleString('en-IN')}\n        </span>\n      ),\n    },\n    {\n      key: 'amount',\n      header: 'Amount',\n      sortable: true,\n      render: (txn) => (\n        <span className=\"font-medium\">{formatCurrency(txn.amount)}</span>\n      ),\n    },\n    {\n      key: 'status',\n      header: 'Status',\n      render: (txn) => (\n        <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n          txn.status === 'success'\n            ? 'bg-green-500/20 text-green-400 border border-green-400/30'\n            : txn.status === 'pending'\n            ? 'bg-yellow-500/20 text-yellow-400 border border-yellow-400/30'\n            : 'bg-red-500/20 text-red-400 border border-red-400/30'\n        }`}>\n          {txn.status.toUpperCase()}\n        </span>\n      ),\n    },\n    {\n      key: 'actions',\n      header: 'Actions',\n      render: (txn) => (\n        <button\n          onClick={() => {\n            setSelectedTxn(txn);\n            setShowRefundModal(true);\n          }}\n          className=\"text-sm text-blue-400 hover:text-blue-300\"\n          disabled={txn.status !== 'success'}\n        >\n          Refund\n        </button>\n      ),\n    },\n  ];\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold text-white\">Transactions</h1>\n        <p className=\"text-white/60 mt-2\">View and manage all transactions</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n        {/* Filters Sidebar */}\n        <div className=\"lg:col-span-1\">\n          <FilterPanel filters={filters} onFilterChange={setFilters} />\n        </div>\n\n        {/* Transactions Table */}\n        <div className=\"lg:col-span-3\">\n          <Card variant=\"default\" padding=\"none\">\n            <DataTable\n              data={transactions}\n              columns={columns}\n              onRowClick={(txn) => console.log('View details:', txn)}\n              loading={loading}\n            />\n            <Pagination\n              currentPage={currentPage}\n              totalPages={totalPages}\n              onPageChange={setCurrentPage}\n            />\n          </Card>\n        </div>\n      </div>\n\n      {/* Refund Modal */}\n      {selectedTxn && (\n        <RefundModal\n          transaction={selectedTxn}\n          isOpen={showRefundModal}\n          onClose={() => setShowRefundModal(false)}\n          onConfirm={async (amount, reason) => {\n            await api.processRefund(selectedTxn.id, { amount, reason });\n            fetchTransactions();\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default TransactionsPage;\n```\n\n---\n\n---\n"
}